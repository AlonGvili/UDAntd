{"version":3,"sources":["webpack:///./src/app/ud-element.jsx"],"names":["UdElement","state","hidden","str","substring","length","regexGuid","test","isGuid","props","id","pubSubToken","PubSub","subscribe","onIncomingEvent","bind","eventName","event","type","setState","unsubscribe","console","log","React","Component","UDElementContent","content","tag","attributes","events","loading","hasError","errorMessage","fetchGet","data","error","message","info","hasCallback","loadData","js","$","getScript","getApiPath","e","val","target","value","checked","i","publish","eventId","eventData","preventUnregister","fetchPost","requestId","concat","elements","Array","refs","element","selectedOptions","item","isNaN","push","JSON","stringify","renderComponent","componentName","history","children","map","x","onUserEvent","onChange","onTextboxChanged","onCheckboxChanged","ref","key","createElement","refreshInterval","autoRefresh"],"mappings":"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","file":"ud-element.71c74fd5797f94b34673.bundle.js","sourcesContent":["import React from 'react';\r\nimport renderComponent from './services/render-service.jsx';\r\nimport PubSub from 'pubsub-js';\r\nimport {fetchGet, fetchPost} from './services/fetch-service.jsx';\r\nimport {getApiPath} from 'config';\r\nimport ReactInterval from 'react-interval';\r\nimport ErrorCard from './error-card.jsx';\r\nimport $ from 'jquery';\r\n\r\nexport default class UdElement extends React.Component {\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            hidden: false\r\n        }\r\n    }\r\n\r\n    isGuid(str) {\r\n        if (str == null) { return false }\r\n\r\n        if (str[0] === \"{\") \r\n        {\r\n            str = str.substring(1, str.length - 1);\r\n        }\r\n        var regexGuid = /^(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}$/gi;\r\n        var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r\n        return regexGuid.test(str);\r\n    }\r\n\r\n    componentWillMount() {\r\n        if (!this.isGuid(this.props.id)) {\r\n            this.pubSubToken = PubSub.subscribe(this.props.id, this.onIncomingEvent.bind(this));\r\n        }\r\n    }\r\n\r\n    onIncomingEvent(eventName, event) {\r\n        if (event.type === \"removeElement\") {\r\n            this.setState({\r\n                hidden: true\r\n            })\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.state.hidden && this.pubSubToken != null) {\r\n            PubSub.unsubscribe(this.pubSubToken);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.pubSubToken != null) {\r\n            console.log(this.pubSubToken);\r\n            PubSub.unsubscribe(this.pubSubToken);\r\n        }\r\n    }\r\n\r\n    render() {   \r\n        if (this.state.hidden) {\r\n            return null;\r\n        }\r\n        return <UDElementContent {...this.props} />\r\n    }\r\n}\r\n\r\nclass UDElementContent extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            content : props.content,\r\n            tag : props.tag,\r\n            attributes: props.attributes,\r\n            events: props.events,\r\n            loading: true,\r\n            hasError: false,\r\n            errorMessage: ''\r\n        }\r\n    }\r\n\r\n    loadData()\r\n    { \r\n        fetchGet(\"/api/internal/component/element/\" + this.props.id, function(data) {\r\n            if (data.error) {\r\n                this.setState({\r\n                    hasError: true, \r\n                    errorMessage: data.error.message\r\n                })\r\n                return;\r\n            }\r\n\r\n            this.setState({\r\n                content: data,\r\n                loading: false\r\n            });\r\n        }.bind(this));\r\n    }\r\n\r\n    componentDidCatch(error, info) {\r\n        this.setState({ hasError: true, errorMessage: error.message });\r\n    }\r\n\r\n    componentWillMount() {\r\n        this.pubSubToken = PubSub.subscribe(this.props.id, this.onIncomingEvent.bind(this));\r\n        if (this.props.hasCallback) {\r\n            this.loadData();\r\n        }\r\n        else \r\n        {\r\n            if (this.props.js) {\r\n                $.getScript(getApiPath() + \"/api/internal/javascript/\" + this.props.js, function() {\r\n                    this.setState({\r\n                        loading: false\r\n                    })\r\n                }.bind(this));\r\n            }\r\n            else {\r\n                this.setState({\r\n                    loading: false\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    onTextboxChanged(e) {\r\n        var val = e.target.value;\r\n        this.state.attributes.value = val;\r\n\r\n        this.setState({\r\n            attributes : this.state.attributes\r\n        });\r\n    }\r\n\r\n    onCheckboxChanged(e) {\r\n        var val = e.target.value;\r\n        val = e.target.checked;\r\n        this.state.attributes.checked = val;\r\n\r\n        this.setState({\r\n            attributes : this.state.attributes\r\n        });\r\n\r\n        for(var i = 0; i < this.state.events.length; i++) {\r\n            if (this.state.events[i].event === 'onChange') {\r\n\r\n                var event = this.state.events[i];\r\n\r\n                PubSub.publish('element-event', {\r\n                    type: \"clientEvent\",\r\n                    eventId: event.id,\r\n                    eventName: 'onChange',\r\n                    eventData: val\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (!this.props.preventUnregister) {\r\n            if (this.state.events != null) {\r\n                for(var i = 0; i < this.state.events.length; i++) {\r\n                    PubSub.publish('element-event', {\r\n                        type: \"unregisterEvent\",\r\n                        eventId: this.state.events[i].id\r\n                    });\r\n                }\r\n            }\r\n    \r\n            if (this.props.hasCallback) {\r\n                PubSub.publish('element-event', {\r\n                    type: \"unregisterEvent\",\r\n                    eventId: this.props.id\r\n                });\r\n            }\r\n        }\r\n\r\n        PubSub.unsubscribe(this.pubSubToken);\r\n    }\r\n\r\n    onIncomingEvent(eventName, event) {\r\n        if (event.type === \"setState\") {\r\n            this.setState(event.state);\r\n        }\r\n        else if (event.type === \"requestState\") {\r\n            fetchPost(`/api/internal/component/element/sessionState/${event.requestId}`, this.state);\r\n        } else if (event.type === \"removeElement\") {\r\n            this.setState({\r\n                hidden: true\r\n            })\r\n        } else if (event.type === \"addElement\") {\r\n\r\n            var content = this.state.content;\r\n            if (content == null) {\r\n                content = []\r\n            }\r\n\r\n            content = content.concat(event.elements);\r\n\r\n            this.setState({\r\n                content\r\n            })\r\n        } else if (event.type === \"clearElement\") {\r\n            this.setState({\r\n                content: null\r\n            })\r\n        } else if (event.type === \"syncElement\") {\r\n            this.loadData();\r\n        }\r\n    }\r\n\r\n    onUserEvent(event, e) {\r\n        var eventName = null;\r\n        var val = null;\r\n        if (this.state.tag === 'select') {\r\n\r\n            val = new Array();\r\n\r\n            if (this.refs.element.selectedOptions) {\r\n                for(var item in  this.refs.element.selectedOptions) {\r\n                    if (isNaN(item)) continue;\r\n                    var value = this.refs.element.selectedOptions[item].value;\r\n                    val.push(value);\r\n                }\r\n            }\r\n            else {\r\n                val.push(this.refs.element.value);\r\n            }\r\n\r\n            if (val.length === 1) {\r\n                val = val[0]\r\n            }\r\n            else {\r\n                val = JSON.stringify(val);\r\n            }\r\n\r\n            for(var i = 0; i < this.state.events.length; i++) {\r\n                if (this.state.events[i].event === 'onChange') {\r\n                    event = this.state.events[i];\r\n                }\r\n            }\r\n            eventName = 'onChange'\r\n        }\r\n        else {\r\n            eventName = event.event;\r\n            val = e.target.value;\r\n            if (val != null && val.checked != null) {\r\n                val = e.target.checked;\r\n            }\r\n        }\r\n\r\n        this.state.attributes.value = val;\r\n        this.setState(this.state);\r\n\r\n        PubSub.publish('element-event', {\r\n            type: \"clientEvent\",\r\n            eventId: event.id,\r\n            eventName: eventName,\r\n            eventData: val\r\n        });\r\n    }\r\n\r\n    render() {\r\n        if (this.state.hidden) {\r\n            return null;\r\n        }\r\n\r\n        if (this.state.hasError) {\r\n            return <ErrorCard message={this.state.errorMessage} />\r\n        }\r\n\r\n        if (this.props.error) {\r\n            return <ErrorCard message={this.props.error.message} />\r\n        }\r\n\r\n        if (this.state.loading) {\r\n            return <div></div>\r\n        }\r\n\r\n        if (this.props.js) {\r\n            return renderComponent({\r\n                type: this.props.componentName,\r\n                ...this.props.props\r\n            }, this.props.history)\r\n        }\r\n\r\n        var children = null;\r\n        \r\n        if (this.state.content && this.state.content.map) {\r\n            children = this.state.content.map(function(x) {\r\n                if (x.type != null) {\r\n                    return renderComponent(x, this.props.history);\r\n                } \r\n                return x;\r\n            }.bind(this));\r\n        }\r\n        else if (this.state.content) {\r\n            children = this.state.content;\r\n        }\r\n\r\n        var attributes = this.state.attributes;\r\n\r\n        if (attributes == null) {\r\n            attributes = {}\r\n        }\r\n\r\n        if (attributes.id == null) {\r\n            attributes.id = this.props.id;\r\n        }\r\n\r\n        if (this.state.events != null && this.state.events.map) {\r\n            this.state.events.map(function(event) {\r\n                attributes[event.event] = function(e) {\r\n                    this.onUserEvent(event, e);\r\n                }.bind(this);\r\n                return null;\r\n            }.bind(this));\r\n        }\r\n\r\n        if (this.state.tag === \"input\") {\r\n            if (attributes.type === \"text\" || attributes.type === \"password\") {\r\n                attributes.onChange = this.onTextboxChanged.bind(this);\r\n            }\r\n\r\n            if (attributes.type === \"checkbox\") {\r\n                attributes.onChange = this.onCheckboxChanged.bind(this);\r\n            }\r\n        }\r\n\r\n        if (this.state.tag === \"textarea\") {\r\n            attributes.onChange = this.onTextboxChanged.bind(this);\r\n        }\r\n\r\n        attributes.ref = 'element';\r\n        attributes.key = this.props.key;\r\n\r\n        this.element = React.createElement(this.state.tag, attributes, children);\r\n\r\n    return [this.element, \r\n            <ReactInterval timeout={this.props.refreshInterval * 1000} enabled={this.props.autoRefresh} callback={this.loadData.bind(this)}/>];\r\n    }\r\n}"],"sourceRoot":""}